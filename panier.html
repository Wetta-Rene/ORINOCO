<!DOCTYPE html>

<html lang="fr">
    <head>
        <meta charset="utf-8" />
        <link type="text/css" rel="stylesheet" href="css/styles.css" />
        <script src="js/scripts.js"></script>
        <title>ORINOCO - Panier</title>
    </head>

<body>
<script>
        var produitsLocal = JSON.parse(localStorage.getItem("panier")); // on recupere le panier en local

            for(let x in produitsLocal) { // on balaye le contenu du panier
                var ligneProduitLocal = produitsLocal[x];  //>> recherche  ligneProduitLocal.nom
                //requette XML vers le backend pour recuperer image et description
                 let xhttp;
                    xhttp = new XMLHttpRequest();
                    xhttp.onreadystatechange = function () {
                        if (this.readyState == 4 && this.status == 200) {
                            let produitServeur = JSON.parse(this.responseText);
                                    var prixAjour = ligneProduitLocal.quantite * produitServeur.price;
                                    

                            
                            let ligne = '<article id="ContenairePanier"><div class="contenaireLignePanier"><div class="element-lignePanier"><img src="'+produitServeur.imageUrl+'" ></div><div class="element-lignePanier">'+produitServeur.name+'<br/>'+ligneProduitLocal.option+'</div><div class="element-lignePanier">'+produitServeur.description+'</div><div class="element-lignePanier">'+produitServeur.price+'</div><div class="element-lignePanier">'+ligneProduitLocal.quantite+'</div><div class="element-lignePanier">'+prixAjour+'</div><div class="element-lignePanier">+<br />-</div></div></article>';  
                                    
                            //affichage du panier
                             document.getElementById("resultats").innerHTML += ligne;                           
                            
                            
                            
                        }//fin du if readyState
                    };
                    xhttp.open("GET", "http://localhost:3000/api/"+ligneProduitLocal.catalogue+"/"+ligneProduitLocal.reference, true);
                    xhttp.send();
  
            }// fin for produilocal
            

    
    
    
    



    



</script>
<header>
    <button><a href="index.html">Accueil</a></button>
    <button><a href="panier.html">Panier</a></button>
</header>

<section id="resultats">

    
    
    
    
    
    
    
</section>
</body>
<footer>
</footer>
</html>